assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(1:4, function(i) return(env.ra.vars[length(env.ra.vars) / 5 * i]))
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(1:4, function(i) return(env.ra.vars[length(env.ra.vars) / 5 * i])); env.ra.vars.grpd
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i)}:{5+(i)}])); env.ra.vars.grpd
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i)}:{5+(i)}])); t(as.data.frame(env.ra.vars.grpd))
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i)}:{5+(i)}])); env.ra.vars.grpd
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i*5)}:{5+(i*5)}])); env.ra.vars.grpd
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
th <- "q.001, q.005"
source("./Scripts/EfDrIdentifier.R")
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i*5)}:{5+(i*5)}])); env.ra.vars.grpd
pancan.achilles.na.imp <- df.NA.to.val(pancan.achilles, 2, "median")
topVar <- apply(pancan.achilles.na.imp, 2, var)
summary(topVar)
pancan.achilles.topVar <- pancan.achilles.na.imp[, topVar > quantile(topVar, probs = 0.95, na.rm = T)]
dim(pancan.achilles.topVar)
models <- list()
for (i in 1:(ncol(pancan.achilles.topVar))) {
models[[i]] <- summary(lm(.env.ra$ef.pancan.max.percl.1 ~ pancan.achilles.topVar[, i]))
}
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
th <- "q.001, q.005"
source("./Scripts/EfDrIdentifier.R")
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i*5)}:{5+(i*5)}])); env.ra.vars.grpd
pancan.achilles.na.imp <- df.NA.to.val(.env.ra$pancan.achilles.fitted.1, 2, "median")
topVar <- apply(pancan.achilles.na.imp, 2, var)
summary(topVar)
pancan.achilles.topVar <- pancan.achilles.na.imp[, topVar > quantile(topVar, probs = 0.95, na.rm = T)]
dim(pancan.achilles.topVar)
models <- list()
for (i in 1:(ncol(pancan.achilles.topVar))) {
models[[i]] <- summary(lm(.env.ra$ef.pancan.max.percl.1 ~ pancan.achilles.topVar[, i]))
}
length(models)
r2 <- c()
for (i in 1:length(models)) {
r2 <- append(r2, unlist(models[[i]]$r.squared))
}
names(r2) <- colnames(pancan.achilles.topVar)
length(r2)
max(r2)
names(r2[which(r2 == max(r2))])
summary(lm(.env.ra$ef.pancan.max.percl.1 ~ pancan.achilles.topVar))
models <- list()
for (i in 1:(ncol(pancan.achilles.topVar))) {
models[[i]] <- summary(lm(.env.ra$ef.pancan.max.percl.2 ~ pancan.achilles.topVar[, i]))
}
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
th <- "q.001, q.005"
source("./Scripts/EfDrIdentifier.R")
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i*5)}:{5+(i*5)}])); env.ra.vars.grpd
pancan.achilles.na.imp <- df.NA.to.val(.env.ra$pancan.achilles.fitted.2, 2, "median")
topVar <- apply(pancan.achilles.na.imp, 2, var)
summary(topVar)
pancan.achilles.topVar <- pancan.achilles.na.imp[, topVar > quantile(topVar, probs = 0.95, na.rm = T)]
dim(pancan.achilles.topVar)
models <- list()
for (i in 1:(ncol(pancan.achilles.topVar))) {
models[[i]] <- summary(lm(.env.ra$ef.pancan.max.percl.2 ~ pancan.achilles.topVar[, i]))
}
length(models)
r2 <- c()
for (i in 1:length(models)) {
r2 <- append(r2, unlist(models[[i]]$r.squared))
}
names(r2) <- colnames(pancan.achilles.topVar)
length(r2)
max(r2)
names(r2[which(r2 == max(r2))])
summary(lm(.env.ra$ef.pancan.max.percl.1 ~ pancan.achilles.topVar))
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
source('~/GitHub/2021-topic-01-team-04/Scripts/Initiator.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
source("Scripts/Initiator.R")
th <- "q.001, q.005"
source("./Scripts/EfDrIdentifier.R")
.env.ra <- new.env(parent = .GlobalEnv)
pancan.achilles <- row.col.cleaner(prism.extractor(prism.achilles))
for (i in 1:5) {
assign(
paste("dr.ef.pancan.max.", i, sep = ""),
dr.to.effect(ef.pancan.perdrug, doscor = 2)[i],
pos = .env.ra)
assign(
paste("id.dr.ef.pancan.max.", i, sep = ""),
as.character(unique(prism.treat[which(prism.treat[, "name"]==names(get(paste("dr.ef.pancan.max.", i, sep = ""), pos = .env.ra))), "broad_id"])),
pos = .env.ra)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
pancan.perdrug[, get(paste("id.dr.ef.pancan.max.", i, sep = ""), pos = .env.ra)],
pos = .env.ra)
names(.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]]) <- rownames(pancan.perdrug)
assign(
paste("ef.pancan.max.percl.", i, sep = ""),
get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra)[!is.na(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))],
pos = .env.ra)
del <- c(NULL)
for (j in 1:length(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))) {
if (sum(grepl(names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))[j], rownames(pancan.achilles)))==0) {del <- append(del, j)}
}
if(!is.null(del)) {
.env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]] <- .env.ra[[paste("ef.pancan.max.percl.", i, sep = "")]][-rev(del)]
}
del <- c(NULL)
for (j in 1:nrow(pancan.achilles)) {
if (!{rownames(pancan.achilles)[j] %in% names(get(paste("ef.pancan.max.percl.", i, sep = ""), pos = .env.ra))}) del <- append(del, j)
}
if(!is.null(del)) {
.env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles[-rev(del), ]
} else .env.ra[[paste("pancan.achilles.fitted.", i, sep = "")]] <- pancan.achilles
}
env.ra.vars <- ls(pos = .env.ra); env.ra.vars
env.ra.vars.grpd <- lapply(0:3, function(i) return(env.ra.vars[{1+(i*5)}:{5+(i*5)}])); env.ra.vars.grpd
pancan.achilles.na.imp <- df.NA.to.val(.env.ra$pancan.achilles.fitted.2, 2, "median")
topVar <- apply(pancan.achilles.na.imp, 2, var)
summary(topVar)
pancan.achilles.topVar <- pancan.achilles.na.imp[, topVar > quantile(topVar, probs = 0.95, na.rm = T)]
dim(pancan.achilles.topVar)
models <- list()
for (i in 1:(ncol(pancan.achilles.topVar))) {
models[[i]] <- summary(lm(.env.ra$ef.pancan.max.percl.2 ~ pancan.achilles.topVar[, i]))
}
length(models)
r2 <- c()
for (i in 1:length(models)) {
r2 <- append(r2, unlist(models[[i]]$r.squared))
}
names(r2) <- colnames(pancan.achilles.topVar)
length(r2)
max(r2)
names(r2[which(r2 == max(r2))])
substitute(.env.ra)
as.character(substitute(.env.ra))
as.character(.env.ra)
environmentName(.env.ra)
environmentName(.env.ra) <- "lala"
environmentName(.GlobalEnv)
if (!exists(as.environment(pos), where = .GlobalEnv)) {
assign(as.character(substitute(pos)), new.env(parent = .GlobalEnv), pos = .GlobalEnv)
} else rm(list = ls(pos = as.environment(pos)))
if (!exists(as.environment(.env.ra), where = .GlobalEnv)) {
assign(as.character(substitute(.env.ra)), new.env(parent = .GlobalEnv), pos = .GlobalEnv)
} else rm(list = ls(pos = as.environment(.env.ra)))
!exists(as.character(substitute(pos)), where = .GlobalEnv)
exists(as.character(substitute(pos)), where = .GlobalEnv)
.env.ra
